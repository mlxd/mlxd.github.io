+++
title = "Permutations of n-D data"
draft = false
date = "2017-09-04"
tags = ["math","cs","quantum"]
math = "true"
summary = "Thoughts on permutations of $n$-D data in memory."
+++
Something I have been thinking bout for quite a long time is the means to manipulate high-dimensional (dense) data-sets efficiently. Namely, I wish to allow for the data along any specific orthgonal basis diretion to become adjacent in memory in strides of the length of samples along that axis.

The reason for this? To allow for optimal vectorisation and caching of data when performing computations. Take for example a GPU: if we put data on there we want to access and manipulate it in chunks given by the chosen thread-size. If we access elements out of order, we essentially lose all of the parallelism offered by the device, as the data access will not be performed in the optimal $k$-element wide chunks, but individually at worst, and somewhere in between most likely.

![alt text](/img/ndData.jpg "A sample layout permutation")

For a problem with data defined in the space given by $ijk$, we can define the lexicographical order from fastest to slowest indices to be in the given $ijk$ order. The included image above is an example of rotation about the $j$ axis, showing in the right the respective mappings to new index values (for the sake of my interest I showed slices along $j$ and $i$, but worked with the latter for the remainder). 

The bottom of the image shows the rearrangements of memory from the original (upper) to the rotated (lower) memory configurations. The indices themselves seem to take the following mappings (orig. $\rightarrow $ rot.):

$$ \begin{align}
i & \rightarrow \textrm{stride}(j)-k, \\\\\\
j & \rightarrow j, \\\\\\
k & \rightarrow i, \\ 
\end{align}$$

where the stride() operation returns the spacing between the elements in the given dimension (in this case, the stride of $j$ is the size of $i$).

I intend to find an optimal way to perform this in time, but that is all an hours or two of procrastination can produce. TBC